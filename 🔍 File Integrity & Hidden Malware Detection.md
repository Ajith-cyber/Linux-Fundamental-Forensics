## 🔍 **File Integrity & Hidden Malware Detection**

---

### 📎 `lsattr`

- **Meaning**: Lists file attributes (like immutable, append-only).
    
- **Purpose**: Spot files that are locked or manipulated by rootkits/malware.
    
- **Real Life**: Hidden malware may set a file as immutable so it can’t be deleted.
    
- **Example**:
    
    ```bash
    lsattr /etc/passwd
    ```
    
    Output:
    
    ```
    ----i--------e---- /etc/passwd
    ```
    

---

### 🧪 `md5sum`, `sha256sum`

- **Purpose**: Verify file **integrity or tampering**.
    
- **Example**:
    
    ```bash
    md5sum /bin/ls
    ```
    

---

### 🧠 `strings`

- **Meaning**: Extracts **human-readable text** from binary or suspicious files.
    
- **Real Life Use**: Reverse engineer suspicious files for hardcoded IPs, paths, etc.
    
- **Example**:
    
    ```bash
    strings malware_sample | less
    ```
    

---

## 🧑‍💻 **User Activity Forensics**

---

### 🕒 `lastb`

- **Meaning**: Shows **failed login attempts**.
    
- **Purpose**: Spot brute-force or hacking attempts.
    
- **Example**:
    
    ```bash
    sudo lastb
    ```
    

---

### 🧾 `history`

- **Purpose**: See user’s past commands.
    
- **Real Use**: What did the attacker do? Did they install tools or delete logs?
    
- **Example**:
    
    ```bash
    history | grep rm
    ```
    

---

### 📅 `crontab -l`

- **Meaning**: Lists scheduled tasks for the user.
    
- **Real Life**: Backdoors often hide as scheduled jobs.
    
- **Example**:
    
    ```bash
    crontab -l
    ```
    

---

## 🧩 **File Timeline Analysis**

---

### 🕵️ `stat filename`

- **Meaning**: Shows file metadata (access, modified, created time).
    
- **Purpose**: Spot when a file was tampered.
    
- **Example**:
    
    ```bash
    stat /etc/passwd
    ```
    

---

### 🧭 `find / -type f -newermt "2025-07-01"`

- **Purpose**: Find files **created/changed recently**.
    
- **Example**:
    
    ```bash
    find / -type f -newermt "2025-07-01"
    ```
    

---

## 📡 **Network Behavior / Attack Detection**

---

### 👀 `netstat -antup`

- **Purpose**: Show all active network connections and listening services.
    
- **Real Life**: Find reverse shells, C2 communications.
    
- **Example**:
    
    ```bash
    sudo netstat -antup
    ```
    

---

### 🦠 `ss -p`

- **Meaning**: Lists processes using network ports.
    
- **Example**:
    
    ```bash
    sudo ss -tulpn
    ```
    

---

### 🌐 `lsof -i`

- **Meaning**: Shows which **programs are connected to the internet**.
    
- **Real Use**: Spot malware calling out to remote servers.
    
- **Example**:
    
    ```bash
    sudo lsof -i
    ```
    

---

## 🧬 **System Integrity and Kernel Backdoors**

---

### 🐚 `chkrootkit`

- **Meaning**: Scans for known rootkits on the system.
    
- **Usage**:
    
    ```bash
    sudo chkrootkit
    ```
    

---

### 🧬 `rkhunter`

- **Meaning**: Rootkit Hunter — scans for **hidden files, backdoors, or altered binaries**.
    
- **Example**:
    
    ```bash
    sudo rkhunter --check
    ```
    

---

## 📂 **Suspicious Files and Unusual Permissions**

---

### 🔐 `find / -perm -4000`

- **Meaning**: Lists **SUID binaries** (run as root).
    
- **Real Life**: Attackers may drop SUID shells.
    
- **Example**:
    
    ```bash
    find / -perm -4000 -type f 2>/dev/null
    ```
    

---

### 📌 `du -ahx / | sort -rh | head -20`

- **Purpose**: Find **largest files** – maybe logs, dumps, or planted files.
    
- **Example**:
    
    ```bash
    sudo du -ahx / | sort -rh | head -20
    ```
    

---

## 🧾 **System Logs Deep Dive**

---

### 🧩 `journalctl -xe`

- **Meaning**: Shows **system logs with detailed errors**.
    
- **Purpose**: Investigate service failures, access violations.
    
- **Example**:
    
    ```bash
    journalctl -xe
    ```
    

---

### 🔎 `grep "sudo:" /var/log/auth.log`

- **Purpose**: See **who used sudo** and when.
    
- **Example**:
    
    ```bash
    grep "sudo:" /var/log/auth.log
    ```
    

---

