## ðŸ” **File Integrity & Hidden Malware Detection**

---

### ðŸ“Ž `lsattr`

- **Meaning**: Lists file attributes (like immutable, append-only).
    
- **Purpose**: Spot files that are locked or manipulated by rootkits/malware.
    
- **Real Life**: Hidden malware may set a file as immutable so it canâ€™t be deleted.
    
- **Example**:
    
    ```bash
    lsattr /etc/passwd
    ```
    
    Output:
    
    ```
    ----i--------e---- /etc/passwd
    ```
    

---

### ðŸ§ª `md5sum`, `sha256sum`

- **Purpose**: Verify file **integrity or tampering**.
    
- **Example**:
    
    ```bash
    md5sum /bin/ls
    ```
    

---

### ðŸ§  `strings`

- **Meaning**: Extracts **human-readable text** from binary or suspicious files.
    
- **Real Life Use**: Reverse engineer suspicious files for hardcoded IPs, paths, etc.
    
- **Example**:
    
    ```bash
    strings malware_sample | less
    ```
    

---

## ðŸ§‘â€ðŸ’» **User Activity Forensics**

---

### ðŸ•’ `lastb`

- **Meaning**: Shows **failed login attempts**.
    
- **Purpose**: Spot brute-force or hacking attempts.
    
- **Example**:
    
    ```bash
    sudo lastb
    ```
    

---

### ðŸ§¾ `history`

- **Purpose**: See userâ€™s past commands.
    
- **Real Use**: What did the attacker do? Did they install tools or delete logs?
    
- **Example**:
    
    ```bash
    history | grep rm
    ```
    

---

### ðŸ“… `crontab -l`

- **Meaning**: Lists scheduled tasks for the user.
    
- **Real Life**: Backdoors often hide as scheduled jobs.
    
- **Example**:
    
    ```bash
    crontab -l
    ```
    

---

## ðŸ§© **File Timeline Analysis**

---

### ðŸ•µï¸ `stat filename`

- **Meaning**: Shows file metadata (access, modified, created time).
    
- **Purpose**: Spot when a file was tampered.
    
- **Example**:
    
    ```bash
    stat /etc/passwd
    ```
    

---

### ðŸ§­ `find / -type f -newermt "2025-07-01"`

- **Purpose**: Find files **created/changed recently**.
    
- **Example**:
    
    ```bash
    find / -type f -newermt "2025-07-01"
    ```
    

---

## ðŸ“¡ **Network Behavior / Attack Detection**

---

### ðŸ‘€ `netstat -antup`

- **Purpose**: Show all active network connections and listening services.
    
- **Real Life**: Find reverse shells, C2 communications.
    
- **Example**:
    
    ```bash
    sudo netstat -antup
    ```
    

---

### ðŸ¦  `ss -p`

- **Meaning**: Lists processes using network ports.
    
- **Example**:
    
    ```bash
    sudo ss -tulpn
    ```
    

---

### ðŸŒ `lsof -i`

- **Meaning**: Shows which **programs are connected to the internet**.
    
- **Real Use**: Spot malware calling out to remote servers.
    
- **Example**:
    
    ```bash
    sudo lsof -i
    ```
    

---

## ðŸ§¬ **System Integrity and Kernel Backdoors**

---

### ðŸš `chkrootkit`

- **Meaning**: Scans for known rootkits on the system.
    
- **Usage**:
    
    ```bash
    sudo chkrootkit
    ```
    

---

### ðŸ§¬ `rkhunter`

- **Meaning**: Rootkit Hunter â€” scans for **hidden files, backdoors, or altered binaries**.
    
- **Example**:
    
    ```bash
    sudo rkhunter --check
    ```
    

---

## ðŸ“‚ **Suspicious Files and Unusual Permissions**

---

### ðŸ” `find / -perm -4000`

- **Meaning**: Lists **SUID binaries** (run as root).
    
- **Real Life**: Attackers may drop SUID shells.
    
- **Example**:
    
    ```bash
    find / -perm -4000 -type f 2>/dev/null
    ```
    

---

### ðŸ“Œ `du -ahx / | sort -rh | head -20`

- **Purpose**: Find **largest files** â€“ maybe logs, dumps, or planted files.
    
- **Example**:
    
    ```bash
    sudo du -ahx / | sort -rh | head -20
    ```
    

---

## ðŸ§¾ **System Logs Deep Dive**

---

### ðŸ§© `journalctl -xe`

- **Meaning**: Shows **system logs with detailed errors**.
    
- **Purpose**: Investigate service failures, access violations.
    
- **Example**:
    
    ```bash
    journalctl -xe
    ```
    

---

### ðŸ”Ž `grep "sudo:" /var/log/auth.log`

- **Purpose**: See **who used sudo** and when.
    
- **Example**:
    
    ```bash
    grep "sudo:" /var/log/auth.log
    ```
    

---

